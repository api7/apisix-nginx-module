diff --git src/http/ngx_http_request.c src/http/ngx_http_request.c
index 013b7158e..1d1c4968c 100644
--- src/http/ngx_http_request.c
+++ src/http/ngx_http_request.c
@@ -898,6 +898,27 @@ ngx_http_ssl_servername(ngx_ssl_conn_t *ssl_conn, int *ad, void *arg)
         goto done;
     }
 
+#if (defined TLS1_3_VERSION                                                   \
+     && !defined LIBRESSL_VERSION_NUMBER && !defined OPENSSL_IS_BORINGSSL)
+
+    /*
+     * SSL_SESSION_get0_hostname() is only available in OpenSSL 1.1.1+,
+     * but servername being negotiated in every TLSv1.3 handshake
+     * is only returned in OpenSSL 1.1.1+ as well
+     */
+
+    const char  *hostname;
+
+    hostname = SSL_SESSION_get0_hostname(SSL_get0_session(ssl_conn));
+
+    if (hostname != NULL && ngx_strcmp(hostname, servername) != 0) {
+        c->ssl->handshake_rejected = 1;
+        *ad = SSL_AD_ACCESS_DENIED;
+        return SSL_TLSEXT_ERR_ALERT_FATAL;
+    }
+
+#endif
+
     rc = ngx_http_find_virtual_server(c, hc->addr_conf->virtual_names, &host,
                                       NULL, &cscf);
 
